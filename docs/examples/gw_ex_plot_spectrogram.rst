===============================
GWpy.Ex: plotting a spectrogram
===============================

.. currentmodule:: gwpy.spectrogram.core


Problem
-------

I would like to plot a spectrogram (time-frequency-amplitude heat map) of the gravitational wave strain signal.

Solution
--------

First up, we need to decide what times we want:

.. literalinclude:: ../../examples/gw_ex_plot_spectrogram.py
   :lines: 11,20-21

Now, using the network data server (NDS) we can fetch the data into a :class:`~gwpy.timeseries.core.TimeSeries`:

.. literalinclude:: ../../examples/gw_ex_plot_spectrogram.py
   :lines: 12,24

A spectrogram is calculated as an array of spectra, stacked along the time-axis, and is generated by calling the :meth:`~gwpy.timeseries.core.TimeSeries.spectrogram` method of the existing timeseries:

.. literalinclude:: ../../examples/gw_ex_plot_spectrogram.py
   :lines: 27

The :meth:`~gwpy.timeseries.core.TimeSeries.spectrogram` method calculated a power spectrogram, and so we take a square root to get the amplitude spectrogram:

.. literalinclude:: ../../examples/gw_ex_plot_spectrogram.py
   :lines: 28

We can now convert the spectrogram to a logarithmic frequency scale:

.. literalinclude:: ../../examples/gw_ex_plot_spectrogram.py
   :lines: 29

and plot it:

.. plot:: ../examples/gw_ex_plot_spectrogram.py
