.. currentmodule:: gwpy.spectrogram.core

=====================================================================
GWpy.Ex: plotting a ratio `Spectrogram`
=====================================================================

Problem
-------

I would like to calculate a spectrogram of the gravitational-wave strain signal, plot a spectrogram (time-frequency-amplitude heat map) of the gravitational wave strain signal.

Solution
--------

First up, we need to decide what times we want:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 28,37-38

Now, using the network data server (NDS) we can fetch the data into a :class:`~gwpy.timeseries.core.TimeSeries`:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 29,41

A spectrogram is calculated as an array of spectra, stacked along the time-axis, and is generated by calling the :meth:`~gwpy.timeseries.core.TimeSeries.spectrogram` method of the existing timeseries:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 45

The :meth:`~gwpy.timeseries.core.TimeSeries.spectrogram` method calculated a power spectrogram, and so we take a square root to get the amplitude spectrogram:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 46

Now, we can calculate the ratio of the data against the median spectrum over the full span:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 47

Not we can plot it:

.. literalinclude:: ../../examples/gw_ex_plot_median_spectrogram.py
   :lines: 50-55

.. plot:: ../examples/gw_ex_plot_median_spectrogram.py
